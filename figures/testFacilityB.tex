\begin{figure}

\centering

\begin{tikzpicture}

% Air Supply
\draw ( 0.5, 0 ) -- ++( 0, -2.1 ) -- ++( 1.5, 0 );
\draw ( 0.7, 0 ) -- ++( 0, -1.9 ) -- ++( 1.3, 0 );
\draw ( 2, -2.5 ) rectangle ++( 0.2, 1 );
\draw ( 2.2, -2.1 ) rectangle ++( 0.05, 0.2 );
\draw ( 2.25, -2.5 ) rectangle ++( 0.2, 1 );

\draw ( 2.45, -2.1 ) -- ++( 2.55, 0 ) -- ++( 0, -1.8 ) -- ++( -2.55, 0 );
\draw ( 2.45, -4.1 ) -- ++( 2.75, 0 ) -- ++( 0, 1 ) -- ++( 2.8, 0 );
\draw [red] ( 3.5, -2 ) circle ( 0.2 );
\draw [red] ( 3.5, -2 ) circle ( 0.175 );
\draw [red] ( 3.35, -2.1 ) -- ++( 0.3, 0.2 );
\draw [red] ( 3.35, -1.9 ) -- ++( 0.3, -0.2 );

\draw ( -0.7, 0 ) -- ++( 0, -4.1 ) -- ++( 2.7, 0 );
\draw ( -0.5, 0 ) -- ++( 0, -3.9 ) -- ++( 2.5, 0 );
\draw ( 2, -4.5 ) rectangle ++( 0.2, 1 );
\draw ( 2.2, -4.1 ) rectangle ++( 0.05, 0.2 );
\draw ( 2.25, -4.5 ) rectangle ++( 0.2, 1 );
\draw [red] ( 3.5, -4 ) circle ( 0.2 );
\draw [red] ( 3.5, -4 ) circle ( 0.175 );
\draw [red] ( 3.35, -4.1 ) -- ++( 0.3, 0.2 );
\draw [red] ( 3.35, -3.9 ) -- ++( 0.3, -0.2 );

% Fuel Supply
\draw ( 2.45, -1.9 ) -- ++( 2.75, 0 ) -- ++( 0, -1 ) -- ++( 0.8, 0 ) -- ++( 0, 0.95 ) -- ++( 1, 0 );
\draw ( 8, -2.9 ) -- ++( -1.9, 0 ) -- ++( 0, 0.85 ) -- ++( 0.9, 0 );
\draw ( 7, -2.25 ) rectangle ++( 0.1, 0.5 );
\draw ( 7.1, -2.05 ) rectangle ++( 0.025, 0.1 );
\draw ( 7.125, -2.25 ) rectangle ++( 0.1, 0.5 );
\draw ( 7.225, -2.05 ) -- ++( 0.775, 0 );
\draw ( 7.225, -1.95 ) -- ++( 0.775, 0 );

% Cooling air
\draw ( 0.1, 0 ) -- ++( 0, -1.1 ) -- ++( -0.6, 0 );
\draw ( -0.1, 0 ) -- ++( 0, -0.9 ) -- ++( -0.4, 0 );
\draw ( -0.7, -0.9 ) -- ++( -1.3, 0 );
\draw ( -0.7, -1.1 ) -- ++( -1.3, 0 );

% Upstream flange
\draw ( -1.5, 0 ) rectangle ++( 3, 0.5 );

% Pressure vessel
\draw ( -1, 0.5 ) rectangle ++( 2, 5 );
\draw ( -1.5, 2 ) rectangle ++( 0.5, 2 );
\draw ( 1.5, 2 ) rectangle ++( -0.5, 2 );
\draw ( -0.25, 2 ) rectangle ++( 0.5, 2 );
\draw ( -0.2, 2.05 ) rectangle ++( 0.4, 1.9 );

% Downstream flange
\draw ( -1.5, 5.5 ) rectangle ++( 3, 0.5 );

% Exhaust section
\draw ( -1, 6 ) rectangle ++( 2, 2 );
\draw ( -1.5, 8 ) rectangle ++( 3, 0.5 );
\draw ( -1, 8.5 ) -- ++( 0, 0.5 ) .. controls +( 0, 0.5 ) and +( 0, -0.5 ) .. ++( 0.75, 1 );
\draw ( 1, 8.5 ) -- ++( 0, 0.5 ) .. controls +( 0, 0.5 ) and +( 0, -0.5 ) .. ++( -0.75, 1 );
\draw ( -0.5, 10 ) rectangle ++( 1, 0.25 );
\draw ( 3, 11.5 ) -- ++( -3.25, 0 ) -- ++( 0, -1.25 ) -- ++( 0.5, 0 ) -- ++( 0, 0.75 ) -- ++( 2.75, 0 );
\draw ( 1, 6.4 ) -- ++( 1, 0 );
\draw ( 1, 6.5 ) -- ++( 1, 0 );
\draw ( -1, 7.5 ) -- ++( -1, 0 );
\draw ( -1, 7.6 ) -- ++( -1, 0 );
\draw ( 1.5, 11.25 ) circle ( 0.35 );
\draw ( 1.5, 11.25 ) circle ( 0.4 );
\draw ( 1.2, 11 ) -- ++( 0.6, 0.5 );
\draw ( 1.2, 11.5 ) -- ++( 0.6, -0.5 );

% Labels
\draw [->] ( 9.5, -3 ) -- ++( -1.25, 0 );
\node at ( 9, -3 ) [below] {Air};

\draw [->] ( 9.5, -2 ) -- ++( -1.25, 0 );
\node at ( 9, -2 ) [above] {Natural gas};

\draw [->] ( -3.5, -1 ) -- ++( 1.25, 0 );
\node at ( -3, -1 ) [above] {Cooling air};

\draw [->] ( 3.25, 11.25 ) -- ++( 1.5, 0 );
\node at ( 5, 11.25 ) [right] {Exhaust};

\draw [->] ( 3, 6.45 ) -- ++( -0.75, 0 );
\node at ( 3, 6.45 ) [right] {Water (in)};

\draw [->] ( -2.25, 7.55 ) -- ++( -0.75, 0 );
\node at ( -2.5, 7.55 ) [below] {Water (out)};

\filldraw ( 2.225, -4 ) circle ( 0.05 ) -- ++( -0.5, -1 ) node [below] {\(\dot{m}_{core}\)};
\filldraw ( 2.225, -2 ) circle ( 0.05 ) -- ++( 0.5, 1 ) node [above] {\(\dot{m}_{swirl}\)};
\filldraw ( 7.1125, -2 ) circle ( 0.05 ) -- ++( 0.5, 1 ) node [above] {\(\dot{m}_{fuel}\)};

\end{tikzpicture}

\caption[Schematic of Test Facility B]{A schematic of the high pressure testing facility where Configuration B was operated is shown. The locations of the orifice flow meters on the reactant streams and fuel lines are shown. Valves (shown in \textcolor{red}{red}) on the swirl and core flow lines allow for the relative mass flow split to be varied between the two reactant streams. The upstream orifice flow meter on the preheated air line is not shown here.}

\label{fig:testFacilityB}

\end{figure}

